'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _reference = require('@glimmer/reference');

class DynamicVarReference {
    constructor(scope, nameRef) {
        this.scope = scope;
        this.nameRef = nameRef;
        let varTag = this.varTag = (0, _reference.createUpdatableTag)();
        this.tag = (0, _reference.combine)([nameRef.tag, varTag]);
    }
    value() {
        return this.getVar().value();
    }
    get(key) {
        return this.getVar().get(key);
    }
    getVar() {
        let name = String(this.nameRef.value());
        let ref = this.scope.get(name);
        (0, _reference.update)(this.varTag, ref.tag);
        return ref;
    }
}
function getDynamicVar(args, vm) {
    let scope = vm.dynamicScope();
    let nameRef = args.positional.at(0);
    return new DynamicVarReference(scope, nameRef);
}
exports.default = getDynamicVar;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3BhY2thZ2VzL0BnbGltbWVyL3J1bnRpbWUvbGliL2hlbHBlcnMvZ2V0LWR5bmFtaWMtdmFyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBVUEsTUFBQSxtQkFBQSxDQUF5QjtBQUl2QixnQkFBQSxLQUFBLEVBQUEsT0FBQSxFQUFnRjtBQUE1RCxhQUFBLEtBQUEsR0FBQSxLQUFBO0FBQTZCLGFBQUEsT0FBQSxHQUFBLE9BQUE7QUFDL0MsWUFBSSxTQUFVLEtBQUEsTUFBQSxHQUFkLG9DQUFBO0FBQ0EsYUFBQSxHQUFBLEdBQVcsd0JBQVEsQ0FBQyxRQUFELEdBQUEsRUFBbkIsTUFBbUIsQ0FBUixDQUFYO0FBQ0Q7QUFFRCxZQUFLO0FBQ0gsZUFBTyxLQUFBLE1BQUEsR0FBUCxLQUFPLEVBQVA7QUFDRDtBQUVELFFBQUEsR0FBQSxFQUFlO0FBQ2IsZUFBTyxLQUFBLE1BQUEsR0FBQSxHQUFBLENBQVAsR0FBTyxDQUFQO0FBQ0Q7QUFFTyxhQUFNO0FBQ1osWUFBSSxPQUFPLE9BQU8sS0FBQSxPQUFBLENBQWxCLEtBQWtCLEVBQVAsQ0FBWDtBQUNBLFlBQUksTUFBTSxLQUFBLEtBQUEsQ0FBQSxHQUFBLENBQVYsSUFBVSxDQUFWO0FBRUEsK0JBQU8sS0FBUCxNQUFBLEVBQW9CLElBQXBCLEdBQUE7QUFFQSxlQUFBLEdBQUE7QUFDRDtBQXhCc0I7QUEyQnpCLFNBQUEsYUFBQSxDQUFBLElBQUEsRUFBQSxFQUFBLEVBQXNEO0FBQ3BELFFBQUksUUFBUSxHQUFaLFlBQVksRUFBWjtBQUNBLFFBQUksVUFBVSxLQUFBLFVBQUEsQ0FBQSxFQUFBLENBQWQsQ0FBYyxDQUFkO0FBRUEsV0FBTyxJQUFBLG1CQUFBLENBQUEsS0FBQSxFQUFQLE9BQU8sQ0FBUDtBQUNEO2tCQUVELGEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBUYWcsXG4gIFVwZGF0YWJsZVRhZyxcbiAgUGF0aFJlZmVyZW5jZSxcbiAgY29tYmluZSxcbiAgY3JlYXRlVXBkYXRhYmxlVGFnLFxuICB1cGRhdGUsXG59IGZyb20gJ0BnbGltbWVyL3JlZmVyZW5jZSc7XG5pbXBvcnQgeyBEeW5hbWljU2NvcGUsIFZNIGFzIFB1YmxpY1ZNLCBWTUFyZ3VtZW50cywgSGVscGVyIH0gZnJvbSAnQGdsaW1tZXIvaW50ZXJmYWNlcyc7XG5cbmNsYXNzIER5bmFtaWNWYXJSZWZlcmVuY2UgaW1wbGVtZW50cyBQYXRoUmVmZXJlbmNlPHVua25vd24+IHtcbiAgcHVibGljIHRhZzogVGFnO1xuICBwcml2YXRlIHZhclRhZzogVXBkYXRhYmxlVGFnO1xuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgc2NvcGU6IER5bmFtaWNTY29wZSwgcHJpdmF0ZSBuYW1lUmVmOiBQYXRoUmVmZXJlbmNlPHVua25vd24+KSB7XG4gICAgbGV0IHZhclRhZyA9ICh0aGlzLnZhclRhZyA9IGNyZWF0ZVVwZGF0YWJsZVRhZygpKTtcbiAgICB0aGlzLnRhZyA9IGNvbWJpbmUoW25hbWVSZWYudGFnLCB2YXJUYWddKTtcbiAgfVxuXG4gIHZhbHVlKCk6IHVua25vd24ge1xuICAgIHJldHVybiB0aGlzLmdldFZhcigpLnZhbHVlKCk7XG4gIH1cblxuICBnZXQoa2V5OiBzdHJpbmcpOiBQYXRoUmVmZXJlbmNlPHVua25vd24+IHtcbiAgICByZXR1cm4gdGhpcy5nZXRWYXIoKS5nZXQoa2V5KTtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0VmFyKCk6IFBhdGhSZWZlcmVuY2U8dW5rbm93bj4ge1xuICAgIGxldCBuYW1lID0gU3RyaW5nKHRoaXMubmFtZVJlZi52YWx1ZSgpKTtcbiAgICBsZXQgcmVmID0gdGhpcy5zY29wZS5nZXQobmFtZSk7XG5cbiAgICB1cGRhdGUodGhpcy52YXJUYWcsIHJlZi50YWcpO1xuXG4gICAgcmV0dXJuIHJlZjtcbiAgfVxufVxuXG5mdW5jdGlvbiBnZXREeW5hbWljVmFyKGFyZ3M6IFZNQXJndW1lbnRzLCB2bTogUHVibGljVk0pOiBQYXRoUmVmZXJlbmNlPHVua25vd24+IHtcbiAgbGV0IHNjb3BlID0gdm0uZHluYW1pY1Njb3BlKCk7XG4gIGxldCBuYW1lUmVmID0gYXJncy5wb3NpdGlvbmFsLmF0KDApO1xuXG4gIHJldHVybiBuZXcgRHluYW1pY1ZhclJlZmVyZW5jZShzY29wZSwgbmFtZVJlZik7XG59XG5cbmV4cG9ydCBkZWZhdWx0IGdldER5bmFtaWNWYXIgYXMgSGVscGVyO1xuIl0sInNvdXJjZVJvb3QiOiIifQ==