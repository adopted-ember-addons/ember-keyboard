'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.EPOCH = undefined;
exports.setStateFor = setStateFor;
exports.getStateFor = getStateFor;

var _util = require('@glimmer/util');

var _validators = require('./validators');

var _tags = require('./tags');

class PrivateImpl {
    constructor() {
        this.inner = undefined;
    }
    get() {
        return this.inner;
    }
    set(value) {
        this.inner = value;
    }
}
const PRIVATES = new WeakMap();
function privateFor(object, key) {
    let privates;
    if (PRIVATES.has(object)) {
        privates = PRIVATES.get(object);
    } else {
        privates = (0, _util.dict)();
        PRIVATES.set(object, privates);
    }
    if (key in privates) {
        return privates[key];
    } else {
        let p = new PrivateImpl();
        privates[key] = p;
        return p;
    }
}
const EPOCH = exports.EPOCH = (0, _validators.createTag)();
function setStateFor(object, key, value) {
    (0, _validators.dirty)(EPOCH);
    (0, _tags.dirtyTag)(object, key);
    privateFor(object, key).set(value);
}
function getStateFor(object, key) {
    return privateFor(object, key).get();
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3BhY2thZ2VzL0BnbGltbWVyL3JlZmVyZW5jZS9saWIvdHJhY2tlZC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7UUE4Q00sVyxHQUFBLFc7UUFVQSxXLEdBQUEsVzs7OztBQXZETjs7QUFDQTs7QUFTQSxNQUFBLFdBQUEsQ0FBaUI7QUFBakIsa0JBQUE7QUFDVSxhQUFBLEtBQUEsR0FBQSxTQUFBO0FBU1Q7QUFQQyxVQUFHO0FBQ0QsZUFBTyxLQUFQLEtBQUE7QUFDRDtBQUVELFFBQUEsS0FBQSxFQUFZO0FBQ1YsYUFBQSxLQUFBLEdBQUEsS0FBQTtBQUNEO0FBVGM7QUFZakIsTUFBTSxXQUFXLElBQWpCLE9BQWlCLEVBQWpCO0FBRUEsU0FBQSxVQUFBLENBQUEsTUFBQSxFQUFBLEdBQUEsRUFBMEU7QUFDeEUsUUFBQSxRQUFBO0FBRUEsUUFBSSxTQUFBLEdBQUEsQ0FBSixNQUFJLENBQUosRUFBMEI7QUFDeEIsbUJBQVcsU0FBQSxHQUFBLENBQVgsTUFBVyxDQUFYO0FBREYsS0FBQSxNQUVPO0FBQ0wsbUJBQUEsaUJBQUE7QUFDQSxpQkFBQSxHQUFBLENBQUEsTUFBQSxFQUFBLFFBQUE7QUFDRDtBQUVELFFBQUksT0FBSixRQUFBLEVBQXFCO0FBQ25CLGVBQU8sU0FBUCxHQUFPLENBQVA7QUFERixLQUFBLE1BRU87QUFDTCxZQUFJLElBQUksSUFBUixXQUFRLEVBQVI7QUFDQSxpQkFBQSxHQUFBLElBQUEsQ0FBQTtBQUNBLGVBQUEsQ0FBQTtBQUNEO0FBQ0Y7QUFFTSxNQUFNLHdCQUFOLDRCQUFBO0FBRUQsU0FBQSxXQUFBLENBQUEsTUFBQSxFQUFBLEdBQUEsRUFBQSxLQUFBLEVBR087QUFFWCwyQkFBQSxLQUFBO0FBQ0Esd0JBQUEsTUFBQSxFQUFBLEdBQUE7QUFDQSxlQUFBLE1BQUEsRUFBQSxHQUFBLEVBQUEsR0FBQSxDQUFBLEtBQUE7QUFDRDtBQUVLLFNBQUEsV0FBQSxDQUFBLE1BQUEsRUFBQSxHQUFBLEVBRUU7QUFFTixXQUFPLFdBQUEsTUFBQSxFQUFBLEdBQUEsRUFBUCxHQUFPLEVBQVA7QUFDRCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGRpY3QgfSBmcm9tICdAZ2xpbW1lci91dGlsJztcbmltcG9ydCB7IGNyZWF0ZVRhZywgZGlydHkgfSBmcm9tICcuL3ZhbGlkYXRvcnMnO1xuaW1wb3J0IHsgZGlydHlUYWcgfSBmcm9tICcuL3RhZ3MnO1xuXG50eXBlIFByaXZhdGVzPFQ+ID0geyBbSyBpbiBrZXlvZiBUXT86IFByaXZhdGU8VFtLXT4gfTtcblxuaW50ZXJmYWNlIFByaXZhdGU8VD4ge1xuICBnZXQoKTogVCB8IHVuZGVmaW5lZDtcbiAgc2V0KHZhbHVlOiBUKTogdm9pZDtcbn1cblxuY2xhc3MgUHJpdmF0ZUltcGw8VD4gaW1wbGVtZW50cyBQcml2YXRlPFQ+IHtcbiAgcHJpdmF0ZSBpbm5lcjogVCB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZDtcblxuICBnZXQoKTogVCB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMuaW5uZXI7XG4gIH1cblxuICBzZXQodmFsdWU6IFQpOiB2b2lkIHtcbiAgICB0aGlzLmlubmVyID0gdmFsdWU7XG4gIH1cbn1cblxuY29uc3QgUFJJVkFURVMgPSBuZXcgV2Vha01hcDxvYmplY3QsIFByaXZhdGVzPG9iamVjdD4+KCk7XG5cbmZ1bmN0aW9uIHByaXZhdGVGb3I8TyBleHRlbmRzIG9iamVjdCwgSyBleHRlbmRzIGtleW9mIE8+KG9iamVjdDogTywga2V5OiBLKTogUHJpdmF0ZTxPW0tdPiB7XG4gIGxldCBwcml2YXRlczogUHJpdmF0ZXM8Tz47XG5cbiAgaWYgKFBSSVZBVEVTLmhhcyhvYmplY3QpKSB7XG4gICAgcHJpdmF0ZXMgPSBQUklWQVRFUy5nZXQob2JqZWN0KSEgYXMgUHJpdmF0ZXM8Tz47XG4gIH0gZWxzZSB7XG4gICAgcHJpdmF0ZXMgPSBkaWN0KCkgYXMgUHJpdmF0ZXM8Tz47XG4gICAgUFJJVkFURVMuc2V0KG9iamVjdCwgcHJpdmF0ZXMpO1xuICB9XG5cbiAgaWYgKGtleSBpbiBwcml2YXRlcykge1xuICAgIHJldHVybiBwcml2YXRlc1trZXldITtcbiAgfSBlbHNlIHtcbiAgICBsZXQgcCA9IG5ldyBQcml2YXRlSW1wbDxPW0tdPigpO1xuICAgIHByaXZhdGVzW2tleV0gPSBwO1xuICAgIHJldHVybiBwO1xuICB9XG59XG5cbmV4cG9ydCBjb25zdCBFUE9DSCA9IGNyZWF0ZVRhZygpO1xuXG5leHBvcnQgZnVuY3Rpb24gc2V0U3RhdGVGb3I8TyBleHRlbmRzIG9iamVjdCwgSyBleHRlbmRzIGtleW9mIE8+KFxuICBvYmplY3Q6IE8sXG4gIGtleTogSyxcbiAgdmFsdWU6IE9bS11cbik6IHZvaWQge1xuICBkaXJ0eShFUE9DSCk7XG4gIGRpcnR5VGFnKG9iamVjdCwga2V5KTtcbiAgcHJpdmF0ZUZvcihvYmplY3QsIGtleSkuc2V0KHZhbHVlKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFN0YXRlRm9yPE8gZXh0ZW5kcyBvYmplY3QsIEsgZXh0ZW5kcyBrZXlvZiBPPihcbiAgb2JqZWN0OiBPLFxuICBrZXk6IEtcbik6IE9bS10gfCB1bmRlZmluZWQge1xuICByZXR1cm4gcHJpdmF0ZUZvcihvYmplY3QsIGtleSkuZ2V0KCk7XG59XG4iXSwic291cmNlUm9vdCI6IiJ9